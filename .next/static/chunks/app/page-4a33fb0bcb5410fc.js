(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{6243:function(e,i,t){Promise.resolve().then(t.bind(t,8212))},8212:function(e,i,t){"use strict";t.r(i),t.d(i,{default:function(){return f}});var n=t(7437),a=t(1672),s=t(4884),r=t(178),l=t(2098),d=t(8873),o=t(2265),c=t(1550),m=t(2694),u=t(114),x=t(149),h=t(7424),j=t(8902),p=t(7138);function f(){var e,i;let t=(0,c.Gs)(),{player:f,settings:y,loading:k}=(0,m.nn)(),{questCompletions:v,actions:D,workouts:w}=(0,m.tu)(t),[b,g]=(0,o.useState)(null),N=(0,o.useMemo)(()=>f?(0,x.rS)(f.kiTotal):null,[f]),K=(0,o.useMemo)(()=>f?(0,u.y)(f.kiTotal):null,[f]),S=(0,h.ar)(),I=new Set(v.map(e=>e.questId)),_=null!==(e=null==f?void 0:f.kiToday)&&void 0!==e?e:0,C=null!==(i=null==y?void 0:y.dailyKiCap)&&void 0!==i?i:50,Z=w.length;async function q(e){let i=await (0,j.J)({todayISO:t,type:e,note:"quick_action"});g({msg:i.message,kind:i.kiAdded>0?"success":i.capped?"warning":"info"})}async function A(e,i){let n=await (0,h.js)({dateISO:t,questId:e,actionOverride:i});g({msg:n.message,kind:n.kiAdded>0?"success":"info"})}return!k&&f&&y&&N&&K?(0,n.jsxs)("div",{className:"space-y-4",children:[b?(0,n.jsx)(d.Z,{message:b.msg,kind:b.kind,onClose:()=>g(null)}):null,(0,n.jsxs)(a.Z,{title:"Estado del guerrero",right:(0,n.jsxs)("div",{className:"text-xs text-white/60",children:["Hoy: ",(0,n.jsx)("span",{className:"font-semibold text-white/85",children:t})]}),children:[(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4",children:[(0,n.jsx)(r.Z,{label:"KI total",value:String(f.kiTotal)}),(0,n.jsx)(r.Z,{label:"Forma",value:"".concat(N.emoji," ").concat(N.name)}),(0,n.jsx)(r.Z,{label:"Streak",value:"".concat(f.streak," d\xedas")}),(0,n.jsx)(r.Z,{label:"Entrenos hoy",value:"".concat(Z)})]}),(0,n.jsxs)("div",{className:"mt-4 grid gap-4 sm:grid-cols-2",children:[(0,n.jsx)(s.Z,{value:Math.min(_,C),max:C,label:"KI hoy (cap ".concat(C,")")}),(0,n.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-3",children:[(0,n.jsx)("div",{className:"text-xs text-white/60",children:"Progreso a la siguiente transformaci\xf3n"}),K.nextName?(0,n.jsxs)("div",{className:"mt-1 text-sm",children:[(0,n.jsx)("span",{className:"font-semibold",children:K.nextName})," ",(0,n.jsxs)("span",{className:"text-white/60",children:["en ",K.remaining," KI (meta: ",K.nextKi,")"]})]}):(0,n.jsx)("div",{className:"mt-1 text-sm font-semibold",children:"M\xe1xima transformaci\xf3n alcanzada \uD83D\uDC22✨"})]})]}),(0,n.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2",children:[(0,n.jsx)(p.default,{href:"/workout",children:(0,n.jsx)(l.Z,{variant:"primary",children:"Entrenar ahora"})}),(0,n.jsx)(l.Z,{variant:"secondary",onClick:()=>q("walk"),children:"+ Caminata (5 KI)"}),(0,n.jsx)(l.Z,{variant:"secondary",onClick:()=>q("mobility"),children:"+ Movilidad (5 KI)"})]})]}),(0,n.jsx)(a.Z,{title:"Misiones del d\xeda",children:(0,n.jsx)("div",{className:"space-y-3",children:S.map(e=>{let i=I.has(e.questId),t="side_walk_or_mobility"===e.questId,a="main_workout"===e.questId;return(0,n.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-3",children:[(0,n.jsxs)("div",{className:"flex flex-wrap items-start justify-between gap-3",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"text-sm font-semibold",children:e.title}),(0,n.jsx)("div",{className:"text-xs text-white/65",children:e.description})]}),(0,n.jsx)("div",{className:"text-xs text-white/60",children:a?"KI seg\xfan modo":"+".concat(e.rewardKi," KI")})]}),(0,n.jsx)("div",{className:"mt-3 flex flex-wrap gap-2",children:i?(0,n.jsx)("span",{className:"rounded-xl bg-emerald-500/15 px-3 py-2 text-xs text-emerald-100 border border-emerald-500/20",children:"Completada ✅"}):a?(0,n.jsx)(p.default,{href:"/workout",children:(0,n.jsx)(l.Z,{variant:"secondary",children:"Ir a entrenar"})}):t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{variant:"secondary",onClick:()=>A(e.questId,"walk"),children:"Marcar caminata"}),(0,n.jsx)(l.Z,{variant:"secondary",onClick:()=>A(e.questId,"mobility"),children:"Marcar movilidad"})]}):(0,n.jsx)(l.Z,{variant:"secondary",onClick:()=>A(e.questId),children:"Completar"})})]},e.questId)})})}),(0,n.jsxs)(a.Z,{title:"Resumen de hoy",children:[(0,n.jsxs)("div",{className:"text-sm text-white/80",children:["Acciones registradas: ",(0,n.jsx)("span",{className:"font-semibold",children:D.length})]}),(0,n.jsx)("div",{className:"mt-2 space-y-1 text-xs text-white/60",children:0===D.length?(0,n.jsx)("p",{children:"Sin acciones todav\xeda. Haz una misi\xf3n o entrena \uD83D\uDC22"}):D.slice().sort((e,i)=>e.createdAtISO<i.createdAtISO?1:-1).map(e=>(0,n.jsxs)("div",{className:"flex justify-between gap-2",children:[(0,n.jsx)("span",{className:"truncate",children:e.type.replaceAll("_"," ")}),(0,n.jsxs)("span",{className:"font-semibold text-white/80",children:["+",e.kiDelta]})]},String(e.id)))})]})]}):(0,n.jsx)("div",{className:"space-y-4",children:(0,n.jsx)(a.Z,{title:"Cargando...",children:(0,n.jsx)("p",{className:"text-sm text-white/70",children:"Preparando tu dojo \uD83D\uDC22"})})})}},4884:function(e,i,t){"use strict";t.d(i,{Z:function(){return a}});var n=t(7437);function a(e){let{value:i,max:t,label:a}=e,s=t<=0?0:Math.max(0,Math.min(100,Math.round(i/t*100)));return(0,n.jsxs)("div",{className:"space-y-1",children:[a?(0,n.jsx)("div",{className:"text-xs text-white/70",children:a}):null,(0,n.jsx)("div",{className:"h-3 overflow-hidden rounded-full border border-white/10 bg-black/30",children:(0,n.jsx)("div",{className:"h-full bg-white/70",style:{width:"".concat(s,"%")}})}),(0,n.jsxs)("div",{className:"flex justify-between text-[11px] text-white/55",children:[(0,n.jsx)("span",{children:i}),(0,n.jsx)("span",{children:t})]})]})}},178:function(e,i,t){"use strict";t.d(i,{Z:function(){return a}});var n=t(7437);function a(e){let{label:i,value:t}=e;return(0,n.jsxs)("div",{className:"rounded-xl border border-white/10 bg-black/20 px-3 py-2",children:[(0,n.jsx)("div",{className:"text-[11px] text-white/55",children:i}),(0,n.jsx)("div",{className:"text-sm font-semibold text-white/90",children:t})]})}},114:function(e,i,t){"use strict";t.d(i,{y:function(){return a}});var n=t(149);function a(e){var i;let t=(0,n.rS)(e),a=(0,n.$T)(e);return{currentName:"".concat(t.emoji," ").concat(t.name),nextName:a?"".concat(a.emoji," ").concat(a.name):null,currentKi:e,nextKi:null!==(i=null==a?void 0:a.minKi)&&void 0!==i?i:null,remaining:a?Math.max(0,a.minKi-e):null}}},149:function(e,i,t){"use strict";t.d(i,{$T:function(){return s},YD:function(){return n},rS:function(){return a}});let n=[{key:"normal",name:"Normal",minKi:0,emoji:"\uD83D\uDE42"},{key:"kaioken",name:"Kaioken",minKi:100,emoji:"\uD83D\uDD25"},{key:"kaioken10",name:"Kaioken \xd710",minKi:300,emoji:"\uD83D\uDD25\uD83D\uDD25"},{key:"ssj",name:"S\xfaper Saiyan",minKi:600,emoji:"\uD83D\uDC9B"},{key:"ssj2",name:"S\xfaper Saiyan 2",minKi:1e3,emoji:"⚡"},{key:"ssj3",name:"S\xfaper Saiyan 3",minKi:1500,emoji:"\uD83D\uDD25"},{key:"ssj4",name:"S\xfaper Saiyan 4",minKi:2200,emoji:"\uD83E\uDD8D"},{key:"god",name:"S\xfaper Saiyan Dios",minKi:3e3,emoji:"\uD83D\uDD34"},{key:"blue",name:"S\xfaper Saiyan Dios SS",minKi:4e3,emoji:"\uD83D\uDD35"},{key:"blue_kaioken",name:"Dios SS + Kaioken",minKi:5500,emoji:"\uD83D\uDD35\uD83D\uDD25"},{key:"ui",name:"Ultra Instinto",minKi:7e3,emoji:"⚪"},{key:"mui",name:"Ultra Instinto Dominado",minKi:9e3,emoji:"⚪✨"}];function a(e){let i=n[0];for(let t of n)e>=t.minKi&&(i=t);return i}function s(e){for(let i of n)if(e<i.minKi)return i;return null}},7424:function(e,i,t){"use strict";t.d(i,{js:function(){return d},ar:function(){return r}});var n=t(9608);let a=[{questId:"main_workout",title:"Main Quest: Entrenamiento",description:"Completa el entrenamiento del d\xeda (modo completo o corto).",rewardKi:0},{questId:"side_walk_or_mobility",title:"Side Quest: Movimiento suave",description:"Haz una caminata de 20–30 min o movilidad 8–12 min.",rewardKi:5,actionType:"walk"},{questId:"discipline_sleep",title:"Discipline Quest: Descanso",description:"Dorm\xed bien (autodeclarado).",rewardKi:5,actionType:"sleep"},{questId:"discipline_food",title:"Discipline Quest: Alimentaci\xf3n",description:"Com\xed decente hoy (autodeclarado).",rewardKi:5,actionType:"food"}];var s=t(8902);function r(){return a}async function l(e,i){return await n.db.quests.where({dateISO:e,questId:i}).count()>0}async function d(e){let{dateISO:i,questId:t,actionOverride:r}=e;if(await l(i,t))return{kiAdded:0,message:"Quest ya completada hoy."};let d=a.find(e=>e.questId===t);if(!d)throw Error("Quest desconocida");await n.db.quests.add({dateISO:i,questId:t,completedAtISO:new Date().toISOString(),meta:r?{actionOverride:r}:void 0});if("side_walk_or_mobility"===t){let e=await (0,s.J)({todayISO:i,type:null!=r?r:"walk",note:"quest:".concat(t)});return{kiAdded:e.kiAdded,message:e.message}}if(d.actionType){let e=await (0,s.J)({todayISO:i,type:d.actionType,note:"quest:".concat(t)});return{kiAdded:e.kiAdded,message:e.message}}return{kiAdded:0,message:"Quest registrada."}}}},function(e){e.O(0,[635,138,173,971,23,744],function(){return e(e.s=6243)}),_N_E=e.O()}]);