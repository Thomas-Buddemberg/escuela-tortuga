(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[902],{7096:function(e,t,n){Promise.resolve().then(n.bind(n,4585))},4585:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return f}});var r=n(7437),i=n(1672),a=n(4884),s=n(178),l=n(2265);function o(e){let{data:t,width:n="100%",height:i=180,stroke:a="#87e2a5",strokeWidth:s=2,fill:l=null,yMin:o,yMax:u,className:c,grid:d=!0}=e,m={top:8,right:8,bottom:18,left:8},f="number"==typeof n?n:640,h=f-m.left-m.right,x=i-m.top-m.bottom,y=t.length,p=y>0?Math.min(...t.map(e=>e.x)):0,b=y>0?Math.max(...t.map(e=>e.x)):1,v=y>0?Math.min(...t.map(e=>e.y)):0,j=y>0?Math.max(...t.map(e=>e.y)):1,g=null!=o?o:Math.min(0,v),w=null!=u?u:j===v?j+1:j,k=e=>0===h||b===p?m.left:m.left+(e-p)/(b-p)*h,D=e=>0===x||w===g?m.top+x:m.top+(1-(e-g)/(w-g))*x,N="";t.forEach((e,t)=>{let n=k(e.x),r=D(e.y);N+=0===t?"M ".concat(n," ").concat(r):" L ".concat(n," ").concat(r)});let S=null;if(l&&t.length>1){let e=t[0],n=t[t.length-1],r=D(0);S="M ".concat(k(e.x)," ").concat(r),t.forEach(e=>{S+=" L ".concat(k(e.x)," ").concat(D(e.y))}),S+=" L ".concat(k(n.x)," ").concat(r," Z")}let I=[];if(d)for(let e=0;e<=4;e++){let t=m.top+x*e/4;I.push((0,r.jsx)("line",{x1:m.left,x2:m.left+h,y1:t,y2:t,stroke:"#ffffff18",strokeWidth:1},"g-".concat(e)))}return(0,r.jsxs)("svg",{width:n,height:i,viewBox:"0 0 ".concat("number"==typeof n?n:f," ").concat(i),className:c,children:[(0,r.jsx)("rect",{x:0,y:0,width:"number"==typeof n?n:f,height:i,fill:"transparent"}),I,l&&S?(0,r.jsx)("path",{d:S,fill:l,stroke:"none"}):null,(0,r.jsx)("path",{d:N,fill:"none",stroke:a,strokeWidth:s,strokeLinejoin:"round",strokeLinecap:"round"})]})}var u=n(2694),c=n(149),d=n(114),m=n(1550);function f(){var e,t,n,f,h;let{player:x,settings:y,loading:p}=(0,u.nn)(),b=(0,u.rn)(),v=(0,u.e6)(30),j=(0,l.useMemo)(()=>x?(0,c.rS)(x.kiTotal):null,[x]),g=(0,l.useMemo)(()=>x?(0,d.y)(x.kiTotal):null,[x]),w=(0,m.Gs)(),k=(0,l.useMemo)(()=>{let e=new Map;for(let r of b){var t,n;let i=null!==(t=e.get(r.dateISO))&&void 0!==t?t:0;e.set(r.dateISO,i+(null!==(n=r.kiDelta)&&void 0!==n?n:0))}return e},[b]),D=(0,l.useMemo)(()=>{var e,t;if(0===b.length)return[];let n=null!==(t=null===(e=b[0])||void 0===e?void 0:e.dateISO)&&void 0!==t?t:w;(!n||n>w)&&(n=w);let r=[],i=n;for(;i<=w;)r.push(i),i=(0,m.NH)(i,1);return r},[b,w]),N=(0,l.useMemo)(()=>D.map(e=>{var t;return{dateISO:e,y:null!==(t=k.get(e))&&void 0!==t?t:0,x:(0,m.$I)(e).getTime()}}),[D,k]),S=(0,l.useMemo)(()=>{let e=0;return N.map(t=>(e+=t.y,{x:t.x,y:e,dateISO:t.dateISO}))},[N]);return!p&&x&&y&&j&&g?(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)(i.Z,{title:"Resumen",children:[(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3 sm:grid-cols-4",children:[(0,r.jsx)(s.Z,{label:"KI total",value:String(x.kiTotal)}),(0,r.jsx)(s.Z,{label:"Forma actual",value:"".concat(j.emoji," ").concat(j.name)}),(0,r.jsx)(s.Z,{label:"Streak",value:"".concat(x.streak," d\xedas")}),(0,r.jsx)(s.Z,{label:"Cap diario",value:"".concat(y.dailyKiCap," KI")})]}),(0,r.jsx)("div",{className:"mt-4",children:g.nextName?(0,r.jsx)(a.Z,{value:x.kiTotal-(null!==(n=null===(e=c.YD.find(e=>e.key===j.key))||void 0===e?void 0:e.minKi)&&void 0!==n?n:0),max:(null!==(f=g.nextKi)&&void 0!==f?f:x.kiTotal)-(null!==(h=null===(t=c.YD.find(e=>e.key===j.key))||void 0===t?void 0:t.minKi)&&void 0!==h?h:0),label:"Hacia ".concat(g.nextName)}):(0,r.jsx)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-3 text-sm",children:"Est\xe1s en la forma m\xe1xima. Ahora el juego es la constancia \uD83D\uDC22✨"})})]}),(0,r.jsx)(i.Z,{title:"Escalera de transformaciones",children:(0,r.jsx)("div",{className:"space-y-2",children:c.YD.map(e=>{let t=x.kiTotal>=e.minKi,n=e.key===j.key;return(0,r.jsxs)("div",{className:["flex items-center justify-between rounded-2xl border p-3",n?"border-white/25 bg-white/10":"border-white/10 bg-black/20"].join(" "),children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{className:"text-lg",children:e.emoji}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-semibold",children:e.name}),(0,r.jsxs)("div",{className:"text-[11px] text-white/55",children:["Desde KI ",e.minKi]})]})]}),(0,r.jsx)("div",{className:"text-xs",children:t?(0,r.jsx)("span",{className:"rounded-xl border border-emerald-500/25 bg-emerald-500/12 px-2 py-1 text-emerald-100",children:"Desbloqueada"}):(0,r.jsx)("span",{className:"rounded-xl border border-white/10 bg-white/5 px-2 py-1 text-white/60",children:"Bloqueada"})})]},e.key)})})}),(0,r.jsx)(i.Z,{title:"KI diario (hist\xf3rico)",children:(0,r.jsx)("div",{className:"space-y-2",children:0===N.length||N.every(e=>0===e.y)?(0,r.jsx)("div",{className:"text-sm text-white/70",children:"A\xfan no hay historial suficiente para graficar. \xa1Empieza a sumar KI! \uD83D\uDC22"}):(0,r.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-3",children:[(0,r.jsx)(o,{data:N.map((e,t)=>({x:t,y:e.y})),height:180,stroke:"#8bd5ff",fill:"#8bd5ff22",className:"w-full"}),(0,r.jsxs)("div",{className:"mt-2 flex items-center justify-between text-[11px] text-white/55",children:[(0,r.jsx)("span",{children:D[0]}),(0,r.jsx)("span",{children:D[D.length-1]})]})]})})}),(0,r.jsx)(i.Z,{title:"KI acumulado (hist\xf3rico)",children:(0,r.jsx)("div",{className:"space-y-2",children:0===S.length||S.every(e=>0===e.y)?(0,r.jsx)("div",{className:"text-sm text-white/70",children:"A\xfan no hay historial suficiente para graficar."}):(0,r.jsxs)("div",{className:"rounded-2xl border border-white/10 bg-black/20 p-3",children:[(0,r.jsx)(o,{data:S.map((e,t)=>({x:t,y:e.y})),height:180,stroke:"#87e2a5",fill:"#87e2a522",className:"w-full"}),(0,r.jsxs)("div",{className:"mt-2 flex items-center justify-between text-[11px] text-white/55",children:[(0,r.jsx)("span",{children:D[0]}),(0,r.jsx)("span",{children:D[D.length-1]})]})]})})}),(0,r.jsx)(i.Z,{title:"Entrenamientos recientes",children:(0,r.jsx)("div",{className:"space-y-2",children:0===v.length?(0,r.jsx)("div",{className:"text-sm text-white/70",children:"A\xfan no hay entrenamientos guardados."}):v.map(e=>(0,r.jsx)("div",{className:"rounded-xl border border-white/10 bg-black/20 p-3",children:(0,r.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-sm font-semibold",children:e.dateISO}),(0,r.jsxs)("div",{className:"text-[11px] text-white/55",children:["Plantilla ",e.templateId]})]}),(0,r.jsxs)("div",{className:"text-xs text-white/60",children:["Modo: ","capsule_30"===e.mode?"Orgullo 30m":"capsule_60"===e.mode?"Orgullo 60m":e.mode]})]})},String(e.id)))})})]}):(0,r.jsx)("div",{className:"space-y-4",children:(0,r.jsx)(i.Z,{title:"Cargando progreso..."})})}},1672:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7437);function i(e){let{title:t,children:n,right:i}=e;return(0,r.jsxs)("section",{className:"rounded-2xl border border-white/10 bg-white/5 p-4 shadow-soft",children:[t||i?(0,r.jsxs)("header",{className:"mb-3 flex items-start justify-between gap-4",children:[t?(0,r.jsx)("h2",{className:"text-sm font-semibold text-white/90",children:t}):(0,r.jsx)("div",{}),i]}):null,null!=n?n:null]})}},4884:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7437);function i(e){let{value:t,max:n,label:i}=e,a=n<=0?0:Math.max(0,Math.min(100,Math.round(t/n*100)));return(0,r.jsxs)("div",{className:"space-y-1",children:[i?(0,r.jsx)("div",{className:"text-xs text-white/70",children:i}):null,(0,r.jsx)("div",{className:"h-3 overflow-hidden rounded-full border border-white/10 bg-black/30",children:(0,r.jsx)("div",{className:"h-full bg-white/70",style:{width:"".concat(a,"%")}})}),(0,r.jsxs)("div",{className:"flex justify-between text-[11px] text-white/55",children:[(0,r.jsx)("span",{children:t}),(0,r.jsx)("span",{children:n})]})]})}},178:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7437);function i(e){let{label:t,value:n}=e;return(0,r.jsxs)("div",{className:"rounded-xl border border-white/10 bg-black/20 px-3 py-2",children:[(0,r.jsx)("div",{className:"text-[11px] text-white/55",children:t}),(0,r.jsx)("div",{className:"text-sm font-semibold text-white/90",children:n})]})}},1550:function(e,t,n){"use strict";function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date,t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(n,"-").concat(r)}function i(e){let[t,n,r]=e.split("-").map(e=>Number(e));return new Date(t,(null!=n?n:1)-1,null!=r?r:1)}function a(e,t){let n=i(e);return n.setDate(n.getDate()+t),r(n)}function s(e,t){return e===a(t,-1)}n.d(t,{$I:function(){return i},Gs:function(){return r},NH:function(){return a},tn:function(){return s}})},9608:function(e,t,n){"use strict";n.d(t,{C6:function(){return u},Sh:function(){return l},db:function(){return s},j3:function(){return c},wv:function(){return o}});var r=n(4635),i=n(1550);class a extends r.ZP{constructor(){super("turtleKiDB"),this.version(1).stores({player:"id",settings:"id",actions:"++id, dateISO, type, createdAtISO",quests:"++id, dateISO, questId, completedAtISO",workouts:"++id, dateISO, templateId, completedAtISO"})}}let s=new a;async function l(){let[e,t]=await Promise.all([s.player.get("player"),s.settings.get("settings")]),n=new Date().toISOString(),r=(0,i.Gs)();e||await s.player.put({id:"player",kiTotal:0,kiToday:0,streak:0,lastDailyResetISO:r,lastTrainingISO:void 0,createdAtISO:n,updatedAtISO:n}),t||await s.settings.put({id:"settings",dailyKiCap:50,difficulty:"normal",reduceMotion:!1})}async function o(){await s.transaction("rw",[s.player,s.settings,s.actions,s.quests,s.workouts],async()=>{await Promise.all([s.player.clear(),s.settings.clear(),s.actions.clear(),s.quests.clear(),s.workouts.clear()])}),await l()}async function u(){let[e,t,n,r,i]=await Promise.all([s.player.get("player"),s.settings.get("settings"),s.actions.toArray(),s.quests.toArray(),s.workouts.toArray()]);return{exportedAtISO:new Date().toISOString(),player:e,settings:t,actions:n,quests:r,workouts:i}}async function c(e){if(!e||"object"!=typeof e)throw Error("Payload inv\xe1lido");await s.transaction("rw",[s.player,s.settings,s.actions,s.quests,s.workouts],async()=>{await Promise.all([s.player.clear(),s.settings.clear(),s.actions.clear(),s.quests.clear(),s.workouts.clear()]),e.player&&await s.player.put(e.player),e.settings&&await s.settings.put(e.settings),Array.isArray(e.actions)&&e.actions.length&&await s.actions.bulkAdd(e.actions),Array.isArray(e.quests)&&e.quests.length&&await s.quests.bulkAdd(e.quests),Array.isArray(e.workouts)&&e.workouts.length&&await s.workouts.bulkAdd(e.workouts)}),await l()}},114:function(e,t,n){"use strict";n.d(t,{y:function(){return i}});var r=n(149);function i(e){var t;let n=(0,r.rS)(e),i=(0,r.$T)(e);return{currentName:"".concat(n.emoji," ").concat(n.name),nextName:i?"".concat(i.emoji," ").concat(i.name):null,currentKi:e,nextKi:null!==(t=null==i?void 0:i.minKi)&&void 0!==t?t:null,remaining:i?Math.max(0,i.minKi-e):null}}},149:function(e,t,n){"use strict";n.d(t,{$T:function(){return a},YD:function(){return r},rS:function(){return i}});let r=[{key:"normal",name:"Normal",minKi:0,emoji:"\uD83D\uDE42"},{key:"kaioken",name:"Kaioken",minKi:100,emoji:"\uD83D\uDD25"},{key:"kaioken10",name:"Kaioken \xd710",minKi:300,emoji:"\uD83D\uDD25\uD83D\uDD25"},{key:"ssj",name:"S\xfaper Saiyan",minKi:600,emoji:"\uD83D\uDC9B"},{key:"ssj2",name:"S\xfaper Saiyan 2",minKi:1e3,emoji:"⚡"},{key:"ssj3",name:"S\xfaper Saiyan 3",minKi:1500,emoji:"\uD83D\uDD25"},{key:"ssj4",name:"S\xfaper Saiyan 4",minKi:2200,emoji:"\uD83E\uDD8D"},{key:"god",name:"S\xfaper Saiyan Dios",minKi:3e3,emoji:"\uD83D\uDD34"},{key:"blue",name:"S\xfaper Saiyan Dios SS",minKi:4e3,emoji:"\uD83D\uDD35"},{key:"blue_kaioken",name:"Dios SS + Kaioken",minKi:5500,emoji:"\uD83D\uDD35\uD83D\uDD25"},{key:"ui",name:"Ultra Instinto",minKi:7e3,emoji:"⚪"},{key:"mui",name:"Ultra Instinto Dominado",minKi:9e3,emoji:"⚪✨"}];function i(e){let t=r[0];for(let n of r)e>=n.minKi&&(t=n);return t}function a(e){for(let t of r)if(e<t.minKi)return t;return null}},2694:function(e,t,n){"use strict";n.d(t,{rn:function(){return u},nn:function(){return l},tu:function(){return o},e6:function(){return c}});var r=n(4635),i=n(2265);function a(e,t,n){return function(e,t,n){"function"==typeof e?(r=t||[],a=n):(r=[],a=t);var r,a,s=i.useRef({hasResult:!1,result:a,error:null}),l=i.useReducer(function(e){return e+1},0);l[0];var o=l[1],u=i.useMemo(function(){var t="function"==typeof e?e():e;if(!t||"function"!=typeof t.subscribe){if(e===t)throw TypeError("Given argument to useObservable() was neither a valid observable nor a function.");throw TypeError("Observable factory given to useObservable() did not return a valid observable.")}if(!s.current.hasResult&&"undefined"!=typeof window&&("function"!=typeof t.hasValue||t.hasValue())){if("function"==typeof t.getValue)s.current.result=t.getValue(),s.current.hasResult=!0;else{var n=t.subscribe(function(e){s.current.result=e,s.current.hasResult=!0});"function"==typeof n?n():n.unsubscribe()}}return t},r);if(i.useDebugValue(s.current.result),i.useEffect(function(){var e=u.subscribe(function(e){var t=s.current;(null!==t.error||t.result!==e)&&(t.error=null,t.result=e,t.hasResult=!0,o())},function(e){var t=s.current;t.error!==e&&(t.error=e,o())});return"function"==typeof e?e:e.unsubscribe.bind(e)},r),s.current.error)throw s.current.error;return s.current.result}(function(){return(0,r.Y1)(e)},t||[],n)}var s=n(9608);function l(){let e=a(async()=>s.db.player.get("player"),[]),t=a(async()=>s.db.settings.get("settings"),[]);return{player:e,settings:t,loading:!e||!t}}function o(e){let t=a(async()=>s.db.quests.where({dateISO:e}).toArray(),[e]),n=a(async()=>s.db.actions.where({dateISO:e}).toArray(),[e]),r=a(async()=>s.db.workouts.where({dateISO:e}).toArray(),[e]);return{questCompletions:null!=t?t:[],actions:null!=n?n:[],workouts:null!=r?r:[]}}function u(){let e=a(async()=>await s.db.actions.orderBy("dateISO").toArray(),[]);return null!=e?e:[]}function c(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30,t=a(async()=>await s.db.workouts.orderBy("completedAtISO").reverse().limit(e).toArray(),[e]);return null!=t?t:[]}}},function(e){e.O(0,[635,971,23,744],function(){return e(e.s=7096)}),_N_E=e.O()}]);