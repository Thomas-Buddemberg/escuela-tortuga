exports.id=55,exports.ids=[55],exports.modules={6211:(e,t,a)=>{Promise.resolve().then(a.t.bind(a,2994,23)),Promise.resolve().then(a.t.bind(a,6114,23)),Promise.resolve().then(a.t.bind(a,9727,23)),Promise.resolve().then(a.t.bind(a,9671,23)),Promise.resolve().then(a.t.bind(a,1868,23)),Promise.resolve().then(a.t.bind(a,4759,23))},6960:(e,t,a)=>{Promise.resolve().then(a.bind(a,933)),Promise.resolve().then(a.bind(a,6618)),Promise.resolve().then(a.bind(a,5506)),Promise.resolve().then(a.bind(a,9088)),Promise.resolve().then(a.bind(a,8015))},5506:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(326),s=a(7577);let n="tracks",i="meta",o="order";function l(){return new Promise((e,t)=>{let a=indexedDB.open("escuelaAudio",1);a.onupgradeneeded=()=>{let e=a.result;e.objectStoreNames.contains(n)||e.createObjectStore(n,{keyPath:"id",autoIncrement:!0}),e.objectStoreNames.contains(i)||e.createObjectStore(i,{keyPath:"key"})},a.onsuccess=()=>e(a.result),a.onerror=()=>t(a.error)})}function d(e,t,a){return e.transaction(t,a)}async function c(e){let t=await l(),a=[];return await new Promise((r,s)=>{let l=d(t,[n,i],"readwrite");l.objectStore(n).clear(),l.objectStore(i).put({key:o,order:[]});let c=l.objectStore(n);Array.from(e).forEach(e=>{let t={name:e.name,blob:e,createdAtISO:new Date().toISOString()},r=c.add(t);r.onsuccess=()=>{let e=r.result;a.push(e)}}),l.oncomplete=()=>r(),l.onabort=()=>s(l.error),l.onerror=()=>s(l.error)}),await new Promise(async(e,t)=>{let r=d(await l(),[i],"readwrite");r.objectStore(i).put({key:o,order:a}),r.oncomplete=()=>e(),r.onabort=()=>t(r.error),r.onerror=()=>t(r.error)}),(await u()).map(e=>({id:e.id,name:e.name,url:URL.createObjectURL(e.blob)}))}async function u(){let e=await l(),t=await new Promise(t=>{let a=d(e,[i],"readonly").objectStore(i).get(o);a.onsuccess=()=>t(a.result?.order),a.onerror=()=>t(void 0)}),a=d(e,[n],"readonly").objectStore(n),r=e=>new Promise(t=>{let r=a.get(e);r.onsuccess=()=>t(r.result),r.onerror=()=>t(void 0)});if(t&&t.length){let e=[];for(let a of t){let t=await r(a);t&&e.push(t)}return e}return new Promise(e=>{let t=[],r=a.openCursor();r.onsuccess=()=>{let a=r.result;a?(t.push(a.value),a.continue()):e(t)},r.onerror=()=>e(t)})}function m(e){if(!Number.isFinite(e)||e<0)return"0:00";let t=Math.floor(e%60).toString().padStart(2,"0");return`${Math.floor(e/60)}:${t}`}function b(){let e=(0,s.useRef)(null),t=(0,s.useRef)(null),[a,n]=(0,s.useState)([]),[i,o]=(0,s.useState)(0),[l,d]=(0,s.useState)(!1),[u,b]=(0,s.useState)(0),[p,g]=(0,s.useState)(0),[h,w]=(0,s.useState)(!1),[x,y]=(0,s.useState)(1),[f,k]=(0,s.useState)(!1),S=(0,s.useMemo)(()=>a[i],[a,i]),j=async e=>{e&&0!==e.length&&(a.forEach(e=>URL.revokeObjectURL(e.url)),n(await c(e)),o(0),d(!1))};return h?(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{"aria-label":"Show audio player",onClick:()=>w(!1),className:"fixed bottom-3 right-3 z-50 rounded-full bg-blue-600 text-white shadow-lg px-4 py-3 active:scale-95",style:{paddingBottom:"calc(env(safe-area-inset-bottom, 0px) + 0.25rem)"},children:"Player"}),r.jsx("input",{ref:t,type:"file",accept:"audio/*",multiple:!0,className:"hidden",onChange:e=>j(e.target.files)}),r.jsx("audio",{ref:e,preload:"metadata"})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx("footer",{className:"fixed inset-x-0 bottom-0 z-50 border-t border-neutral-800 bg-neutral-900 text-white shadow-lg",style:{paddingBottom:"env(safe-area-inset-bottom, 0px)"},role:"region","aria-label":"Audio player",children:(0,r.jsxs)("div",{className:"flex items-center gap-3 px-3 py-2",children:[r.jsx("button",{onClick:()=>w(!0),"aria-label":"Hide audio player",className:"rounded-md border border-neutral-700 bg-neutral-800 px-2 py-1 text-xs hover:bg-neutral-700",children:"Hide"}),r.jsx("button",{onClick:()=>t.current?.click(),"aria-label":"Select audio files",className:"rounded-md bg-blue-600 px-3 py-2 text-sm font-medium hover:bg-blue-500 active:scale-95",children:"Choose files"}),r.jsx("button",{onClick:()=>{a.length&&o(e=>(e-1+a.length)%a.length)},"aria-label":"Previous track",className:"rounded-md bg-neutral-800 px-3 py-2 hover:bg-neutral-700 active:scale-95",disabled:0===a.length,children:"Prev"}),r.jsx("button",{onClick:()=>{let t=e.current;t&&(t.currentTime=Math.max(0,t.currentTime-30))},"aria-label":"Seek backward 30 seconds",className:"rounded-md bg-neutral-800 px-3 py-2 hover:bg-neutral-700 active:scale-95",disabled:!S,children:"-30s"}),r.jsx("button",{onClick:()=>{let t=e.current;t&&S&&(t.paused?t.play().catch(()=>d(!1)):t.pause())},"aria-label":l?"Pause":"Play",className:"rounded-md bg-green-600 px-3 py-2 font-medium hover:bg-green-500 active:scale-95 disabled:opacity-60",disabled:!S,children:l?"Pause":"Play"}),r.jsx("button",{onClick:()=>{let t=e.current;if(!t)return;let a=Number.isFinite(t.duration)?t.duration:t.currentTime+30;t.currentTime=Math.min(a,t.currentTime+30)},"aria-label":"Seek forward 30 seconds",className:"rounded-md bg-neutral-800 px-3 py-2 hover:bg-neutral-700 active:scale-95",disabled:!S,children:"+30s"}),r.jsx("button",{onClick:()=>{a.length&&o(e=>(e+1)%a.length)},"aria-label":"Next track",className:"rounded-md bg-neutral-800 px-3 py-2 hover:bg-neutral-700 active:scale-95",disabled:0===a.length,children:"Next"}),r.jsx("div",{className:"flex items-center gap-2 flex-1 min-w-[160px]",children:r.jsx("input",{type:"range",min:0,max:Number.isFinite(p)&&p>0?p:0,step:.01,value:Number.isFinite(u)?u:0,onChange:t=>{let a=e.current;if(!a)return;let r=Number(t.target.value);a.currentTime=Number.isFinite(r)?r:0},"aria-label":"Seek position",className:"w-full",disabled:!S||!Number.isFinite(p)||p<=0})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 min-w-[150px]",children:[r.jsx("button",{onClick:()=>k(e=>!e),"aria-label":f?"Unmute":"Mute",className:"rounded-md bg-neutral-800 px-2 py-2 hover:bg-neutral-700 active:scale-95",children:f?"Unmute":"Mute"}),r.jsx("input",{type:"range",min:0,max:1,step:.01,value:f?0:x,onChange:e=>{let t=Number(e.target.value);y(t),f&&t>0&&k(!1)},"aria-label":"Volume",className:"w-24"})]}),(0,r.jsxs)("div",{className:"text-xs tabular-nums min-w-[120px] text-right",children:[m(u)," / ",m(p)]}),r.jsx("div",{className:"truncate max-w-[28ch] text-xs text-neutral-300",children:S?`${i+1}/${a.length} \xb7 ${S.name}`:"No file selected"})]})}),r.jsx("input",{ref:t,type:"file",accept:"audio/*",multiple:!0,className:"hidden",onChange:e=>j(e.target.files)}),r.jsx("audio",{ref:e,preload:"metadata"})]})}},9088:(e,t,a)=>{"use strict";function r(){return null}a.d(t,{default:()=>r}),a(7577),a(6714)},8015:(e,t,a)=>{"use strict";a.d(t,{default:()=>l});var r=a(326),s=a(434),n=a(5047);let i=[{href:"/",label:"Inicio"},{href:"/workout",label:"Entrenar"},{href:"/orgullo",label:"Orgullo Saiyajin"},{href:"/progress",label:"Progreso"},{href:"/dojo",label:"Dojo"},{href:"/settings",label:"Ajustes"}];function o(e,t){return"/"===t?"/"===e:e.startsWith(t)}function l(){let e=(0,n.usePathname)();return(0,r.jsxs)("header",{className:"sticky top-0 z-50 border-b border-white/10 bg-[#0b0f1a]/70 backdrop-blur",children:[(0,r.jsxs)("div",{className:"mx-auto flex max-w-3xl items-center justify-between px-4 py-3",children:[(0,r.jsxs)(s.default,{href:"/",className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex h-8 w-8 items-center justify-center rounded-xl bg-white/10 shadow-soft",children:"\uD83D\uDC22"}),(0,r.jsxs)("div",{className:"leading-tight",children:[r.jsx("div",{className:"text-sm font-semibold",children:"Turtle Ki"}),r.jsx("div",{className:"text-[11px] text-white/60",children:"Escuela de la Tortuga"})]})]}),r.jsx("nav",{className:"hidden gap-1 sm:flex",children:i.map(t=>{let a=o(e,t.href);return r.jsx(s.default,{href:t.href,className:["rounded-xl px-3 py-2 text-sm transition",a?"bg-white/12 text-white":"text-white/70 hover:bg-white/10 hover:text-white"].join(" "),children:t.label},t.href)})})]}),r.jsx("div",{className:"sm:hidden",children:r.jsx("div",{className:"fixed bottom-3 left-0 right-0 z-50",children:r.jsx("div",{className:"mx-auto flex max-w-3xl justify-between gap-1 px-3",children:r.jsx("div",{className:"flex w-full justify-between rounded-2xl border border-white/10 bg-[#0b0f1a]/70 p-1 backdrop-blur shadow-soft",children:i.map(t=>{let a=o(e,t.href);return r.jsx(s.default,{href:t.href,className:["flex-1 rounded-xl px-2 py-2 text-center text-xs transition",a?"bg-white/12 text-white":"text-white/70 hover:bg-white/10 hover:text-white"].join(" "),children:t.label},t.href)})})})})})]})}},2609:(e,t,a)=>{"use strict";function r(e=new Date){let t=e.getFullYear(),a=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t}-${a}-${r}`}function s(e,t){return e===function(e,t){let a=function(e){let[t,a,r]=e.split("-").map(e=>Number(e));return new Date(t,(a??1)-1,r??1)}(e);return a.setDate(a.getDate()+-1),r(a)}(t,0)}a.d(t,{Gs:()=>r,tn:()=>s})},6205:(e,t,a)=>{"use strict";a.d(t,{C6:()=>d,db:()=>i,j3:()=>c,wv:()=>l});var r=a(3864),s=a(2609);class n extends r.ZP{constructor(){super("turtleKiDB"),this.version(1).stores({player:"id",settings:"id",actions:"++id, dateISO, type, createdAtISO",quests:"++id, dateISO, questId, completedAtISO",workouts:"++id, dateISO, templateId, completedAtISO"})}}let i=new n;async function o(){let[e,t]=await Promise.all([i.player.get("player"),i.settings.get("settings")]),a=new Date().toISOString(),r=(0,s.Gs)();e||await i.player.put({id:"player",kiTotal:0,kiToday:0,streak:0,lastDailyResetISO:r,lastTrainingISO:void 0,createdAtISO:a,updatedAtISO:a}),t||await i.settings.put({id:"settings",dailyKiCap:50,difficulty:"normal",reduceMotion:!1})}async function l(){await i.transaction("rw",[i.player,i.settings,i.actions,i.quests,i.workouts],async()=>{await Promise.all([i.player.clear(),i.settings.clear(),i.actions.clear(),i.quests.clear(),i.workouts.clear()])}),await o()}async function d(){let[e,t,a,r,s]=await Promise.all([i.player.get("player"),i.settings.get("settings"),i.actions.toArray(),i.quests.toArray(),i.workouts.toArray()]);return{exportedAtISO:new Date().toISOString(),player:e,settings:t,actions:a,quests:r,workouts:s}}async function c(e){if(!e||"object"!=typeof e)throw Error("Payload inv\xe1lido");await i.transaction("rw",[i.player,i.settings,i.actions,i.quests,i.workouts],async()=>{await Promise.all([i.player.clear(),i.settings.clear(),i.actions.clear(),i.quests.clear(),i.workouts.clear()]),e.player&&await i.player.put(e.player),e.settings&&await i.settings.put(e.settings),Array.isArray(e.actions)&&e.actions.length&&await i.actions.bulkAdd(e.actions),Array.isArray(e.quests)&&e.quests.length&&await i.quests.bulkAdd(e.quests),Array.isArray(e.workouts)&&e.workouts.length&&await i.workouts.bulkAdd(e.workouts)}),await o()}},723:(e,t,a)=>{"use strict";a.d(t,{P_:()=>n,cU:()=>r,wc:()=>s});let r={workout_quick:10,workout_full:20,capsule_30:20,capsule_60:40,walk:5,mobility:5,sleep:5,food:5,streak_bonus:25,manual_adjust:0};function s(e){return"easy"===e?.85:"hard"===e?1.15:1}function n(e){return"streak_bonus"!==e}},6714:(e,t,a)=>{"use strict";a.d(t,{Bw:()=>m,Hz:()=>p,J:()=>d,XI:()=>c,lf:()=>b,nQ:()=>u});var r=a(6205),s=a(723),n=a(2609);async function i(){let e=await r.db.player.get("player");if(!e)throw Error("Player no inicializado");return e}async function o(){let e=await r.db.settings.get("settings");if(!e)throw Error("Settings no inicializado");return e}async function l(e,t){return await r.db.actions.where({dateISO:e,type:t}).count()>0}async function d(e){let{todayISO:t,type:a,note:n}=e,d=s.cU[a]??0;return await l(t,a)?{kiAdded:0,capped:!1,message:"Ya reclamaste esta acci\xf3n hoy."}:await r.db.transaction("rw",r.db.player,r.db.settings,r.db.actions,async()=>{let[e,l]=await Promise.all([i(),o()]),c=new Date().toISOString(),u=d,m=!1;if((0,s.P_)(a)){let t=Math.max(0,l.dailyKiCap-e.kiToday);t<=0?(u=0,m=!0):u>t&&(u=t,m=!0)}let b={...e,kiTotal:e.kiTotal+u,kiToday:e.kiToday+u,updatedAtISO:c};await r.db.player.put(b);let p={dateISO:t,type:a,kiDelta:u,createdAtISO:c,note:n};await r.db.actions.add(p);let g=u>0?`+${u} KI (${a.replaceAll("_"," ")})`:m?"Cap diario alcanzado. Hoy ya hiciste suficiente \uD83D\uDC22":"Acci\xf3n registrada.";return{kiAdded:u,capped:m,message:g}})}async function c(e){let{todayISO:t,templateId:a,mode:d,durationSec:c}=e,u="full"===d?"workout_full":"workout_quick";return await l(t,u)?(await r.db.workouts.add({dateISO:t,templateId:a,completedAtISO:new Date().toISOString(),durationSec:c,mode:d}),{kiAdded:0,streak:(await i()).streak,bonusKi:0,message:"Workout guardado. El KI del workout ya fue reclamado hoy."}):await r.db.transaction("rw",r.db.player,r.db.settings,r.db.actions,r.db.workouts,async()=>{let[e,l]=await Promise.all([i(),o()]),m=new Date().toISOString(),b=s.cU[u]??0,p=!1,g=Math.max(0,l.dailyKiCap-e.kiToday);g<=0?(b=0,p=!0):b>g&&(b=g,p=!0);let h=e.streak,w=0;e.lastTrainingISO!==t&&(h=e.lastTrainingISO&&(0,n.tn)(e.lastTrainingISO,t)?e.streak+1:1)>0&&h%7==0&&(w=s.cU.streak_bonus??0);let x={...e,kiTotal:e.kiTotal+b+w,kiToday:e.kiToday+b+w,streak:h,lastTrainingISO:t,updatedAtISO:m};await r.db.player.put(x),await r.db.actions.add({dateISO:t,type:u,kiDelta:b,createdAtISO:m,note:a}),w>0&&await r.db.actions.add({dateISO:t,type:"streak_bonus",kiDelta:w,createdAtISO:m,note:`streak=${h}`}),await r.db.workouts.add({dateISO:t,templateId:a,completedAtISO:m,durationSec:c,mode:d});let y=b>0?`Entrenamiento completado: +${b} KI${w?` +${w} KI bonus`:""} âœ…`:p?`Entrenamiento guardado. Cap diario alcanzado; hoy no se suma m\xe1s KI ðŸ¢`:"Entrenamiento guardado.";return{kiAdded:b,streak:h,bonusKi:w,message:y}})}async function u(e){let{todayISO:t,templateId:a,variant:d,durationSec:c}=e;return await l(t,d)?(await r.db.workouts.add({dateISO:t,templateId:a,completedAtISO:new Date().toISOString(),durationSec:c,mode:d}),{kiAdded:0,streak:(await i()).streak,bonusKi:0,message:"Workout guardado. El KI ya fue reclamado hoy."}):await r.db.transaction("rw",r.db.player,r.db.settings,r.db.actions,r.db.workouts,async()=>{let[e,l]=await Promise.all([i(),o()]),u=new Date().toISOString(),m=s.cU[d]??0,b=!1,p=Math.max(0,l.dailyKiCap-e.kiToday);p<=0?(m=0,b=!0):m>p&&(m=p,b=!0);let g=e.streak,h=0;e.lastTrainingISO!==t&&(g=e.lastTrainingISO&&(0,n.tn)(e.lastTrainingISO,t)?e.streak+1:1)>0&&g%7==0&&(h=s.cU.streak_bonus??0);let w={...e,kiTotal:e.kiTotal+m+h,kiToday:e.kiToday+m+h,streak:g,lastTrainingISO:t,updatedAtISO:u};await r.db.player.put(w),await r.db.actions.add({dateISO:t,type:d,kiDelta:m,createdAtISO:u,note:a}),h>0&&await r.db.actions.add({dateISO:t,type:"streak_bonus",kiDelta:h,createdAtISO:u,note:`streak=${g}`}),await r.db.workouts.add({dateISO:t,templateId:a,completedAtISO:u,durationSec:c,mode:d});let x=m>0?`Orgullo Saiyajin completado: +${m} KI${h?` +${h} KI bonus`:""} âœ…`:b?`Entrenamiento guardado. Cap diario alcanzado; hoy no se suma m\xe1s KI ðŸ¢`:"Entrenamiento guardado.";return{kiAdded:m,streak:g,bonusKi:h,message:x}})}async function m(e){await r.db.transaction("rw",r.db.settings,async()=>{let t=await o();await r.db.settings.put({...t,dailyKiCap:Math.max(10,Math.min(200,Math.round(e)))})})}async function b(e){await r.db.transaction("rw",r.db.settings,async()=>{let t=await o();await r.db.settings.put({...t,difficulty:e})})}async function p(e){await r.db.transaction("rw",r.db.settings,async()=>{let t=await o();await r.db.settings.put({...t,reduceMotion:e})})}},1871:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w,metadata:()=>h});var r=a(9510);a(5023);var s=a(5782),n=a(8570);let i=(0,n.createProxy)(String.raw`/Users/tbuddemberg/Desktop/Escuela/escuela-tortuga/src/components/Navbar.tsx`),{__esModule:o,$$typeof:l}=i;i.default;let d=(0,n.createProxy)(String.raw`/Users/tbuddemberg/Desktop/Escuela/escuela-tortuga/src/components/Navbar.tsx#default`),c=(0,s.default)(()=>a.e(764).then(a.bind(a,3764)),{loadableGenerated:{modules:["components/AppShell.tsx -> ./AudioPlayer"]},ssr:!1});function u({children:e}){return(0,r.jsxs)("div",{className:"min-h-screen flex flex-col",children:[r.jsx(d,{}),r.jsx("main",{className:"flex-1 mx-auto w-full max-w-3xl px-4 py-4",children:e}),r.jsx(c,{})]})}let m=(0,n.createProxy)(String.raw`/Users/tbuddemberg/Desktop/Escuela/escuela-tortuga/src/components/ClientBootstrap.tsx`),{__esModule:b,$$typeof:p}=m;m.default;let g=(0,n.createProxy)(String.raw`/Users/tbuddemberg/Desktop/Escuela/escuela-tortuga/src/components/ClientBootstrap.tsx#default`),h={title:"Turtle Ki",description:"Escuela de la Tortuga: h\xe1bitos + entrenamiento diario con KI, misiones y transformaciones.",applicationName:"Turtle Ki",manifest:"/manifest.webmanifest",icons:{icon:[{url:"/icons/icon-192.png",sizes:"192x192",type:"image/png"},{url:"/icons/icon-512.png",sizes:"512x512",type:"image/png"}],apple:[{url:"/icons/icon-192.png"}]},themeColor:"#0b0f1a"};function w({children:e}){return r.jsx("html",{lang:"es",children:(0,r.jsxs)("body",{children:[r.jsx(g,{}),r.jsx(u,{children:e})]})})}},5023:()=>{}};